<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>pidman</title>
	<meta name="description" content="Documentation for pidman">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">pidman</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1>pidman</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<h1 align="center">Welcome to Pidman üëã</h1>
				<p>
					<img alt="Version" src="https://img.shields.io/badge/version-1.1.7-blue.svg?cacheSeconds=2592000" />
					<img src="https://img.shields.io/badge/npm-%3E%3D5.8.0-blue.svg" />
					<img src="https://img.shields.io/badge/node-%3E%3D9.3.0-blue.svg" />
					<a href="https://github.com/QAlfy/pidman/wiki" target="_blank">
						<img alt="Documentation" src="https://img.shields.io/badge/documentation-yes-brightgreen.svg" />
					</a>
					<a href="Copyright <YEAR> <COPYRIGHT HOLDER>" target="_blank">
							<img alt="License: MIT" src="https://img.shields.io/badge/License-MIT-yellow.svg" />
					</a>
				</p>
				<blockquote>
					<p>A rock solid process orchestration library for Node (<strong>WIP: Work In Progress)</strong></p>
				</blockquote>
				<a href="#üè†-homepage" id="üè†-homepage" style="color: inherit; text-decoration: none;">
					<h3>üè† <a href="https://pidman.qalfy.com">Homepage</a></h3>
				</a>
				<a href="#about" id="about" style="color: inherit; text-decoration: none;">
					<h2>About</h2>
				</a>
				<p>Pidman is a library designed to make external processes management an easy task.</p>
				<p>It avoids the typical callback hell where you get into when using native API while at the same time enhances the default language functionality by allowing you to create groups of processes, monitor their activity and gives you the option to manage their statuses at any given time, whether there is data flowing, an error occurs or whenever the process closes or exits. If the later, you&#39;ll be provided with all the required information and metadata to help you react accordingly.</p>
				<p>Grouping a serie of external commands or programs is useful when they depend on each other. Obviously, you can run an individual process if you don&#39;t need to manage a group.</p>
				<a href="#goal" id="goal" style="color: inherit; text-decoration: none;">
					<h3>Goal</h3>
				</a>
				<p>The goal of Pidman is to provide the most reliable process management tool without entering into dark territories. It has to remain simple to use and be easy to setup. In a matter of seconds, you should be able to orchestrate a series of programs or external commands while ensuring you won&#39;t loose their traces.</p>
				<a href="#persistence" id="persistence" style="color: inherit; text-decoration: none;">
					<h3>Persistence</h3>
				</a>
				<p>Pidman stores your groups and processes&#39; metadata using <em>Connectors</em>. Currently, there is a single connector called <em>MemoryConnector</em> which can be persisted locally. You&#39;ll be always in sync with the processes that run over Pidman.</p>
				<p>There are plans to add more connectors (NoSQL, MySQL, etc). Contributors are welcome.</p>
				<a href="#logging" id="logging" style="color: inherit; text-decoration: none;">
					<h3>Logging</h3>
				</a>
				<p>Pidman offers a vast set of logging targets to keep you informed. Thanks to the use of <a href="https://github.com/winstonjs/winston/blob/master/docs/transports.md#winston-core">Winston transports</a>, the output of this library can be redirected to either console, Slack, MongoDB, Sentry, New Relic, a file, a stream and dozens of other popular destinations.</p>
				<p>Just include the preferred one when initializing the <code>Pidman</code> instance:</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> SlackHook = <span class="hljs-built_in">require</span>(<span class="hljs-string">"winston-slack-webhook-transport"</span>);

<span class="hljs-keyword">const</span> pm = <span class="hljs-keyword">new</span> Pidman({
  <span class="hljs-attr">logger</span>: {
    <span class="hljs-attr">transport</span>: <span class="hljs-keyword">new</span> SlackHook({
      <span class="hljs-attr">webhookUrl</span>: <span class="hljs-string">"https://hooks.slack.com/services/xxx/xxx/xxx"</span>,
    }),
  },
});</code></pre>
				<a href="#thread-behavior" id="thread-behavior" style="color: inherit; text-decoration: none;">
					<h3>Thread Behavior</h3>
				</a>
				<p>Pidman run processes in forked mode. This means, your program&#39;s event loop won&#39;t be locked. This is a pseudo-thread mechanism that allows running commands and programs on the background while you keep listening for any event that might arise during execution of these commands.</p>
				<a href="#daemons-and-background-processes" id="daemons-and-background-processes" style="color: inherit; text-decoration: none;">
					<h3>Daemons and Background Processes</h3>
				</a>
				<p>If you run a command that spawns itself as a background process or daemon, Pidman will not be able to kill it properly. This is because the program will detach itself from its parent hence the new daemonized/background process will run unattached from the main Node&#39;s process running your code.</p>
				<a href="#prerequisites" id="prerequisites" style="color: inherit; text-decoration: none;">
					<h2>Prerequisites</h2>
				</a>
				<ul>
					<li>npm &gt;=5.8.0</li>
					<li>node &gt;=9.3.0</li>
				</ul>
				<a href="#install" id="install" style="color: inherit; text-decoration: none;">
					<h2>Install</h2>
				</a>
				<pre><code class="language-sh">npm i pidman</code></pre>
				<p>or</p>
				<pre><code class="language-sh">yarn add pidman</code></pre>
				<a href="#typescript-setup" id="typescript-setup" style="color: inherit; text-decoration: none;">
					<h3>Typescript Setup</h3>
				</a>
				<p>If you use Typescript, don&#39;t forget to target ES2015 or higher in your <code>tsconfig.json</code>:</p>
				<pre><code class="language-json">  &quot;compilerOptions&quot;: {
    ...
    &quot;target&quot;: [&quot;ES2015&quot;],
    ...
  }</code></pre>
				<a href="#api--documentation" id="api--documentation" style="color: inherit; text-decoration: none;">
					<h2>API / Documentation</h2>
				</a>
				<p>There is a detailed <a href="https://pidman.qalfy.com/">API Documentation</a>.</p>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h2>Usage</h2>
				</a>
				<p>For a quick hands-on usage explanation, check out the <a href="https://github.com/QAlfy/pidman/blob/master/test/basic.demo.js">basic demo</a> and read the comments in there.</p>
				<p>First, instantiate the main Pidman&#39;s class:</p>
				<pre><code class="language-js"><span class="hljs-keyword">import</span> { Pidman } <span class="hljs-keyword">from</span> <span class="hljs-string">"pidman"</span>;

<span class="hljs-keyword">const</span> pm = <span class="hljs-keyword">new</span> Pidman();</code></pre>
				<p>You can optionally provide a <a href="https://pidman.qalfy.com/interfaces/_core_pidman_.pidmanoptions.html">PidmanOptions</a> to the <a href="https://pidman.qalfy.com/classes/_core_pidman_.pidman.html">Pidman</a> constructor. An example would be specifying a <a href="#Logging">logging transport</a>.</p>
				<a href="#group" id="group" style="color: inherit; text-decoration: none;">
					<h3>Group</h3>
				</a>
				<p>Let&#39;s start adding a <a href="https://pidman.qalfy.com/classes/_core_group_.pidmangroup.html">PidmanGroup</a> which will contain one or more <a href="https://pidman.qalfy.com/classes/_core_process_.pidmanprocess.html">PidmanProcess</a>.</p>
				<p>A group simplifies the management of multiple commands and programs which relate to each other within a specific domain or context in your application. For example, if you need to run some maintenance commands when a user removes a document or triggers some action, then you can have a group do this job.</p>
				<p>A <code>PidmanGroup</code> accepts a <a href="https://pidman.qalfy.com/interfaces/_core_group_.groupoptions.html">GroupOptions</a> as unique argument on construction. The meaning of these options are explained <a href="https://pidman.qalfy.com/interfaces/_core_group_.groupoptions.html">here</a>. You can choose to initialize the processes using the <code>processes</code> array in the options or by later using the <a href="https://pidman.qalfy.com/classes/_core_group_.pidmangroup.html#addprocess">addProcess</a> method:</p>
				<pre><code class="language-js"><span class="hljs-keyword">import</span> { Pidman, PidmanGroup } <span class="hljs-keyword">from</span> <span class="hljs-string">"pidman"</span>;

<span class="hljs-keyword">const</span> pm = <span class="hljs-keyword">new</span> Pidman();
<span class="hljs-keyword">const</span> group = <span class="hljs-keyword">new</span> PidmanGroup();

group.addProcess({
  <span class="hljs-attr">path</span>: <span class="hljs-string">"/home/someuser"</span>,
  <span class="hljs-attr">command</span>: <span class="hljs-string">"rm -rf ./docs"</span>,
});</code></pre>
				<p>The only required property is <code>command</code>, otherwise nothing runs. You can see a description of the different options <a href="https://pidman.qalfy.com/interfaces/_core_process_.processoptions.html">here</a>. You can optionally identify this group using a unique <code>id</code> string or let Pidman choose a random one.</p>
				<a href="#process" id="process" style="color: inherit; text-decoration: none;">
					<h3>Process</h3>
				</a>
				<p>A <a href="https://pidman.qalfy.com/classes/_core_process_.pidmanprocess.html">PidmanProcess</a> can be run inside a group or isolated. Although, you can join a process to any group whenever you need to. It&#39;s a flexible mechanism.</p>
				<pre><code class="language-js"><span class="hljs-keyword">import</span> { someEvent } <span class="hljs-keyword">from</span> <span class="hljs-string">'./events'</span>;
<span class="hljs-keyword">import</span> { Pidman, PidmanGroup, PidmanProcess } <span class="hljs-keyword">from</span> <span class="hljs-string">"pidman"</span>;

<span class="hljs-keyword">const</span> pm = <span class="hljs-keyword">new</span> Pidman();
<span class="hljs-keyword">const</span> group = <span class="hljs-keyword">new</span> PidmanGroup();

group.addProcess({
  <span class="hljs-attr">path</span>: <span class="hljs-string">"/home/someuser"</span>,
  <span class="hljs-attr">command</span>: <span class="hljs-string">"rm -rf ./docs"</span>,
});

<span class="hljs-keyword">const</span> lockProcess = <span class="hljs-keyword">new</span> PidmanProcess({
  <span class="hljs-attr">user</span>: <span class="hljs-string">"www"</span>,
  <span class="hljs-attr">group</span>: <span class="hljs-string">"www"</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">"/var/www"</span>,
  <span class="hljs-attr">command</span>: <span class="hljs-string">"touch"</span>,
  <span class="hljs-attr">arguments</span>: [<span class="hljs-string">"lock"</span>],
});

group.addProcess(lockProcess);

someEvent.on(<span class="hljs-string">'doit'</span>, () =&gt; {
  group.run();
});</code></pre>
				<a href="#monitor-groups-and-process" id="monitor-groups-and-process" style="color: inherit; text-decoration: none;">
					<h3>Monitor Groups and Process</h3>
				</a>
				<p>You can choose to monitor special events coming from a group&#39;s children processes or individually on each process. The callback signatures are detailed <a href="https://pidman.qalfy.com/interfaces/_core_pidman_.pidmanmonitor.html">here</a>:</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> group = <span class="hljs-keyword">new</span> PidmanGroup({
  <span class="hljs-attr">monitor</span>: {
    <span class="hljs-attr">onData</span>: <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      <span class="hljs-comment">// data.output is the process's stdout and stderr</span>
      <span class="hljs-built_in">console</span>.log(data.output)
    },
    <span class="hljs-attr">onClose</span>: <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (event.exitCode &amp;&amp; event.exitCode !== <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'ouch! something is wrong: '</span>);
        <span class="hljs-built_in">console</span>.error(event.process.output);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">console</span>.info(<span class="hljs-string">`process <span class="hljs-subst">${event.process.options.id}</span> closed at <span class="hljs-subst">${event.time}</span>`</span>);
      }
    }
  }
});</code></pre>
				<a href="#kill-39em-all" id="kill-39em-all" style="color: inherit; text-decoration: none;">
					<h3>Kill &#39;Em All</h3>
				</a>
				<p>By providing (<strong>or not</strong>) a valid <a href="https://nodejs.org/api/process.html#process_signal_events">program termination signal</a>, you can choose to kill all processes in a group at once or individually:</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> killed = <span class="hljs-keyword">await</span> group.kill();</code></pre>
				<p>or</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> killed = <span class="hljs-keyword">await</span> lockProcess.kill(<span class="hljs-string">'SIGKILL'</span>);</code></pre>
				<a href="#author" id="author" style="color: inherit; text-decoration: none;">
					<h2>Author</h2>
				</a>
				<p>üë§ <strong>Nicolas Iglesias</strong></p>
				<ul>
					<li>Website: <a href="https://pidman.qalfy.com">https://pidman.qalfy.com</a></li>
					<li>Github: <a href="https://github.com/webpolis">@webpolis</a></li>
				</ul>
				<a href="#ü§ù-contributing" id="ü§ù-contributing" style="color: inherit; text-decoration: none;">
					<h2>ü§ù Contributing</h2>
				</a>
				<p>Contributions, issues and feature requests are welcome!<br />Feel free to check <a href="https://github.com/QAlfy/pidman/issues">issues page</a>.</p>
				<a href="#show-your-support" id="show-your-support" style="color: inherit; text-decoration: none;">
					<h2>Show your support</h2>
				</a>
				<p>Give a ‚≠êÔ∏è if this project helped you!</p>
				<a href="#üìù-license" id="üìù-license" style="color: inherit; text-decoration: none;">
					<h2>üìù License</h2>
				</a>
				<p>Copyright ¬© 2020 <a href="https://github.com/webpolis">Nicolas Iglesias</a>.<br />
				This project is <a href="https://github.com/QAlfy/pidman/blob/master/LICENSE">MIT</a> licensed.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_connector_index_.html">&quot;connector/index&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_connector_memory_.html">&quot;connector/memory&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_core_forked_.html">&quot;core/forked&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_core_group_.html">&quot;core/group&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_core_index_.html">&quot;core/index&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_core_pidman_.html">&quot;core/pidman&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_core_process_.html">&quot;core/process&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_index_.html">&quot;index&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_utils_event_.html">&quot;utils/event&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_utils_index_.html">&quot;utils/index&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_utils_logger_.html">&quot;utils/logger&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_utils_process_.html">&quot;utils/process&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_utils_strings_.html">&quot;utils/strings&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_utils_sys_.html">&quot;utils/sys&quot;</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>